---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  message = FALSE,
  error = FALSE,
  warning = FALSE,
  comment = "#>"
)
```

# Análise de dados macrofitas-cpfl

## Carregando Pacotes

```{r}
library(tidyverse)
library(ExpDes.pt)
```
#### [Análise multivariada](https://github.com/arpanosso/macrofitas-cpfl/Docs/analise-multivariada.html)

#### [Análise de variância](https://github.com/arpanosso/macrofitas-cpfl/Docs/analise-varianca.html)

## Pré-processamento
```{r}
sheets <- readxl::excel_sheets("data-raw/dadoscpfl.xlsx")
```
### Composição química

Leitura do banco
```{r}
df <- readxl::read_xlsx("data-raw/dadoscpfl.xlsx",
                        sheet = sheets[1],
                        skip = 1) %>% 
  rename(data = "...1") %>% 
  janitor::clean_names() %>% 
  mutate(
    amostra = str_to_lower(amostra),
    cd = as.numeric(ifelse(cd == "<1",0.5,cd)),
    cr = as.numeric(ifelse(cr == "<1",0.5,cr)),
    pb = as.numeric(ifelse(pb == "<1",0.5,pb))
  )
```
Resumo rápido do banco de dados

```{r}
glimpse(df)
```

Resumo geral
```{r}
skimr::skim(df)
```

## Salvar o df em rds

```{r}
write_rds(df,"data/quimica-macrofita")
```


#### Corrplot geral
```{r}
# A programar
```


#### Corrplot por data
```{r}
# A programar
```

### Experimento de apicação em solo

Leitura do banco
```{r}
dff <- readxl::read_xlsx("data-raw/dadoscpfl.xlsx",
                        sheet = sheets[2],
                        skip = 1) %>% 
  janitor::clean_names() %>% 
  mutate(
    cr = ifelse(is.na(cr),0,cr),
    cd = ifelse(is.na(cd),0,cd)
  )
```
Resumo rápido do banco de dados

```{r}
glimpse(dff)
```

Resumo geral
```{r}
skimr::skim(dff)
```

## Salvar o df em rds

```{r}
write_rds(dff,"data/solo-macrofita")
```


#### Boxplot por tratamentos por variável
```{r}
# A programar
dff %>% 
  filter(macrofita != "TESTEM") %>% 
  ggplot(aes(x=macrofita,y=mo, fill=macrofita)) +
  geom_boxplot() +
  facet_wrap(~dose_t_ha, scales = "free", ncol = 1) +
  theme_bw()
```










